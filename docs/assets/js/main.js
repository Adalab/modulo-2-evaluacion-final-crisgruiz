"use strict";const inputElement=document.querySelector(".js-input"),btnElement=document.querySelector(".js-searchBtn"),listElement=document.querySelector(".js-list"),favElement=document.querySelector(".js-favContainer");let shows=[],favorites=[];function handleGetToApi(){const e=inputElement.value.toLowerCase();fetch("https://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{shows=e.map(e=>e.show),paintSeries()})}function paintSeries(){let e="";for(const t of shows){let i=getImageShow(t);if(isValidSerie(t)){let s;s=findIdInArrayOfObjets(t.id,favorites)?"fav":" ",e+=`<li class="previewSerie js-series ${s}" id="${t.id}">`,e+=`<h3 class="previewSerie__title js-serieTitle">${t.name}</h3>`,e+=`<img class="previewSerie__img js-serieImg" src="${i}" class="">`,e+="</li>"}}listElement.innerHTML=e,listenSeriesEvent()}function isValidSerie(e){const t=inputElement.value.toLowerCase();return e.name.toLowerCase().includes(t)}function findIdInArrayOfObjets(e,t){for(let i=0;i<t.length;i++)if(t[i].id===e)return!0}function getImageShow(e){return null===e.image?"https://via.placeholder.com/210x295/ffffff/666666/?text="+e.name:e.image.medium}function listenSeriesEvent(){const e=document.querySelectorAll(".js-series");for(const t of e)t.addEventListener("click",handleFavorite)}function handleFavorite(e){const t=parseInt(e.currentTarget.id),i=favorites.findIndex(e=>e.id===t),s=shows.findIndex(e=>e.id===t);-1!==i?favorites.splice(i,1):favorites.push(shows[s]),paintFavorites(),paintSeries(),setInLocalStorage()}function paintFavorites(){let e="";e+='<ul class = "favSerie">';for(const t of favorites){let i=getImageShow(t);e+=`<li class="favSerie-list js-favSeries" id="${t.id}">`,e+=`<h3 class="favSerie-list__title js-favSerieTitle">${t.name}</h3>`,e+=`<img class="favSerie-list__img js-favSerieImg" src="${i}" class="">`,e+="</li>"}e+="</ul>",favElement.innerHTML=e}function setInLocalStorage(){const e=JSON.stringify(favorites);localStorage.setItem("favorites",e)}function getFromLocalStorage(){const e=localStorage.getItem("favorites");if(null!==e){const t=JSON.parse(e);favorites=t,paintFavorites()}}btnElement.addEventListener("click",handleGetToApi),getFromLocalStorage();