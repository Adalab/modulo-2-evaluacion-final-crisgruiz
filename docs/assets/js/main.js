"use strict";const inputElement=document.querySelector(".js-input"),btnElement=document.querySelector(".js-searchBtn"),listElement=document.querySelector(".js-list"),favElement=document.querySelector(".js-favContainer");let shows=[],favorites=[];function handleGetToApi(){const e=inputElement.value.toLowerCase();fetch("https://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{shows=e.map(e=>e.show),paintSeries(),setInLocalStorage()})}function paintSeries(){let e="";for(const t of shows){let s=GetImagesDefault(t);if(isValidSerie(t)){let i;i=t.favorite?"fav":" ",e+=`<li class="previewSerie js-series ${i}" id="${t.id}">`,e+=`<h3 class="previewSerie__title js-serieTitle">${t.name}</h3>`,e+=`<img class="previewSerie__img js-serieImg" src="${s}" class="">`,e+="</li>"}}listElement.innerHTML=e,listenSeriesEvent()}function isValidSerie(e){const t=inputElement.value.toLowerCase();return e.name.toLowerCase().includes(t)}function GetImagesDefault(e){return e.image?e.image.medium:"https://via.placeholder.com/210x295/ffffff/666666/?text="+e.name}function GetImagesFav(e){return e.image?e.image.medium:"https://via.placeholder.com/210x295/ffffff/666666/?text="+e.name}function listenSeriesEvent(){const e=document.querySelectorAll(".js-series");for(const t of e)t.addEventListener("click",handleFavorite)}function handleFavorite(e){const t=parseInt(e.currentTarget.id),s=favorites.findIndex(e=>e.id===t),i=shows.findIndex(e=>e.id===t);-1!==s?(favorites.splice(s,1),shows[i].favorite=!1):(favorites.push(shows[i]),shows[i].favorite=!0),paintFavorites(),paintSeries(),setInLocalStorage()}function paintFavorites(){let e="";e+='<ul class = "favSerie">';for(const t of favorites){let s=GetImagesFav(t);e+=`<li class="favSerie-list js-favSeries" id="${t.id}">`,e+=`<h3 class="favSerie-list__title js-favSerieTitle">${t.name}</h3>`,e+=`<img class="favSerie-list__img js-favSerieImg" src="${s}" class="">`,e+="</li>"}e+="</ul>",favElement.innerHTML=e}function setInLocalStorage(){const e=JSON.stringify(favorites);localStorage.setItem("favorites",e)}function getFromLocalStorage(){const e=localStorage.getItem("favorites");if(null===e)handleGetToApi();else{const t=JSON.parse(e);favorites=t,paintFavorites()}}btnElement.addEventListener("click",handleGetToApi),getFromLocalStorage();